custom:
  enable_rule_generator: true
  overwrite_original_rules: true





rule-providers:
  LAN:
    type: http
    behavior: classical
    url: "https://raw.githubusercontent.com/AlexyZheng/subconverter-rs/refs/heads/main/base/rules/ACL4SSR/Clash/LAN.yaml"
    interval: 86400 # Checks for updates daily
    path: ./ruleset/LAN.yaml
    format: yaml
  RussianServices:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/AlexyZheng/subconverter-rs/refs/heads/main/base/rules/ACL4SSR/Clash/RussianServices.mrs"
    interval: 86400
    path: ./ruleset/RussianServices.mrs
    format: mrs
  telegram_voip_nets:
    type: http
    behavior: ipcidr
    url: "https://raw.githubusercontent.com/fernvenue/telegram-cidr-list/refs/heads/master/CIDR.yaml"
    interval: 86400 # Checks for updates daily
    path: ./ruleset/telegram_voip_nets.yaml
    format: yaml
  AI:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/AlexyZheng/subconverter-rs/refs/heads/main/base/rules/ACL4SSR/Clash/AI.mrs"
    interval: 86400
    path: ./ruleset/AI.mrs
    format: mrs
  Github:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/AlexyZheng/subconverter-rs/refs/heads/main/base/rules/ACL4SSR/Clash/Github.mrs"
    interval: 86400
    path: ./ruleset/Github.mrs
    format: mrs
  GoogleCNIP:
    type: http
    behavior: ipcidr
    url: "https://raw.githubusercontent.com/AlexyZheng/subconverter-rs/refs/heads/main/base/rules/ACL4SSR/Clash/GoogleCNIP.yaml"
    interval: 86400 # Checks for updates daily
    path: ./ruleset/GoogleCNIP.yaml
    format: yaml
  GoogleCN:
    type: http
    behavior: domain
    url: "https://raw.githubusercontent.com/AlexyZheng/subconverter-rs/refs/heads/main/base/rules/ACL4SSR/Clash/GoogleCN.mrs"
    interval: 86400 # Checks for updates daily
    path: ./ruleset/GoogleCN.mrs
    format: mrs

prepend-rules:
  - RULE-SET,LAN,DIRECT
  - RULE-SET,Github,Github
  - RULE-SET,AI,✦︎ AI
  - RULE-SET,telegram_voip_nets,Telegram,no-resolve,network,tcp,DST-PORT,80/443/5222
  - RULE-SET,telegram_voip_nets,Telegram,no-resolve,network,udp,DST-PORT,596/597/598/599/1400/4000-5000
  - RULE-SET,RussianServices,俄羅斯國內 РФ В пределах


append-rules:
  - RULE-SET,GoogleCNIP,漏网之魚 Непойманная рыба
  - RULE-SET,GoogleCN,漏网之魚 Непойманная рыба
  - MATCH,漏网之魚 Непойманная рыба

# --- 1. Rule Provider Definition (Fetches Dynamic IPs) ---
rule-providers:
  telegram_voip_nets:
    type: http
    # This behavior is critical for processing the CIDR list correctly
    behavior: ipcidr
    url: "https://raw.githubusercontent.com/fernvenue/telegram-cidr-list/refs/heads/master/CIDR.yaml"
    interval: 86400 # Checks for updates daily
    path: ./ruleset/telegram_voip_nets.yaml

# --- 2. Rules Section (Applies Selective Filtering) ---
rules:
  # TCP Signaling Traffic: Targets the dynamic IP list on call setup ports (80, 443, 5222)
  - RULE-SET,telegram_voip_nets,Telegram,no-resolve,network,tcp,DST-PORT,80/443/5222

  # UDP Media Traffic: Targets the dynamic IP list on real-time media ports (596-599, 1400, 4000-5000)
  - RULE-SET,telegram_voip_nets,Telegram,no-resolve,network,udp,DST-PORT,596/597/598/599/1400/4000-5000

  # Placeholder for other general rules that subconverter will append later.
  # (e.g., GEOIP, FINAL MATCH, etc.)
  # If you are using a base template, ensure standard rules are included here or added by subconverter.
