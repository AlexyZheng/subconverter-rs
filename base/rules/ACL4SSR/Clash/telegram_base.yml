# telegram_base.yml (Custom YAML Template Content)

[custom]
;不要随意改变关键字，否则会导致出错
;acl4SSR规则

;去广告：支持
;自动测速：支持
;苹果分流：支持
;增强中国IP段：支持
;增强国外GFW：支持

;设置规则标志位


ruleset=🖧 LAN,https://raw.githubusercontent.com/AlexyZheng/subconverter-rs/refs/heads/main/base/rules/ACL4SSR/Clash/LocalAreaNetwork.list


ruleset=中俄网魚單 КНР-РФ Пойманной рыбы,https://raw.githubusercontent.com/AlexyZheng/subconverter-rs/refs/heads/main/base/rules/ACL4SSR/Clash/RussiaChinaWhitelist.list

ruleset=✦︎ AI,https://raw.githubusercontent.com/AlexyZheng/subconverter-rs/refs/heads/main/base/rules/ACL4SSR/Clash/AI.list


ruleset=▶️ Youtube,https://raw.githubusercontent.com/AlexyZheng/subconverter-rs/refs/heads/main/base/rules/ACL4SSR/Clash/Youtube.list


ruleset=РФ,https://raw.githubusercontent.com/AlexyZheng/subconverter-rs/refs/heads/main/base/rules/ACL4SSR/Clash/RussiaOnly.list

ruleset=Github,https://raw.githubusercontent.com/AlexyZheng/subconverter-rs/refs/heads/main/base/rules/ACL4SSR/Clash/Github.list

ruleset=中國國內 КНР В пределах,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ChinaCompanyIp.list
ruleset=中國國內 КНР В пределах,https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ChinaDomain.list
ruleset=中國國內 КНР В пределах,[]GEOIP,CN
ruleset=俄羅斯國內 РФ В пределах,[]GEOIP,RU

ruleset=漏网之魚 Непойманная рыба,https://raw.githubusercontent.com/AlexyZheng/subconverter-rs/refs/heads/main/base/rules/ACL4SSR/Clash/GoogleCN.list
ruleset=漏网之魚 Непойманная рыба,[]FINAL



;设置规则标志位

;设置分组标志位
custom_proxy_group=♻️ 自动选择 Автовыбор`url-test`.*`http://www.gstatic.com/generate_204`300,,100
custom_proxy_group=♻️ 自动回退 Отступление`fallback`.*`http://www.gstatic.com/generate_204`300,,200
custom_proxy_group=中俄网魚單 КНР-РФ Пойманной рыбы`select`[]♻️ 自动选择 Автовыбор`.*`[]DIRECT
custom_proxy_group=中國國內 КНР В пределах`select`[]DIRECT`.*
custom_proxy_group=俄羅斯國內 РФ В пределах`select`[]DIRECT`.*

custom_proxy_group=Telegram`select`[]♻️ 自动选择 Автовыбор`[]DIRECT

custom_proxy_group=Github`select`[]DIRECT`[]♻️ 自动选择 Автовыбор

custom_proxy_group=▶️ Youtube`select`[]♻️ 自动选择 Автовыбор`[]DIRECT

custom_proxy_group=✦︎ AI`select`[]♻️ 自动回退 Отступление`[]DIRECT
custom_proxy_group=РФ`select`[]♻️ 自动回退 Отступление`[]DIRECT

custom_proxy_group=漏网之魚 Непойманная рыба`select`[]DIRECT`[]♻️ 自动选择 Автовыбор
custom_proxy_group=🖧 LAN`select`[]DIRECT


enable_rule_generator=true
overwrite_original_rules=false

;clash_rule_base=https://raw.githubusercontent.com/AlexyZheng/subconverter-rs/refs/heads/main/base/rules/ACL4SSR/Clash/telegram_base.yml


;luck





# --- 1. Rule Provider Definition (Fetches Dynamic IPs) ---
rule-providers:
  telegram_voip_nets:
    type: http
    # This behavior is critical for processing the CIDR list correctly
    behavior: ipcidr
    url: "https://raw.githubusercontent.com/fernvenue/telegram-cidr-list/refs/heads/master/CIDR.yaml"
    interval: 86400 # Checks for updates daily
    path:./ruleset/telegram_voip_nets.yaml

# --- 2. Rules Section (Applies Selective Filtering) ---
rules:
  # TCP Signaling Traffic: Targets the dynamic IP list on call setup ports (80, 443, 5222)
  - RULE-SET,telegram_voip_nets,Telegram,no-resolve,network,tcp,DST-PORT,80/443/5222

  # UDP Media Traffic: Targets the dynamic IP list on real-time media ports (596-599, 1400, 4000-5000)
  - RULE-SET,telegram_voip_nets,Telegram,no-resolve,network,udp,DST-PORT,596/597/598/599/1400/4000-5000

  # Placeholder for other general rules that subconverter will append later.
  # (e.g., GEOIP, FINAL MATCH, etc.)
  # If you are using a base template, ensure standard rules are included here or added by subconverter.
